{"version":3,"sources":["assets\\script\\PlayerControl.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class PlayerControl extends cc.Component {\r\n\r\n    // 子弹预设体\r\n    @property(cc.Prefab)\r\n    bullet:cc.Prefab = null;\r\n    // 子弹发射位置\r\n    firePoint:cc.Node = null;\r\n    // 声音\r\n    @property(cc.AudioClip)\r\n    moveClip:cc.AudioClip = null;\r\n    @property(cc.AudioClip)\r\n    shootClip:cc.AudioClip = null;\r\n\r\n    // 输入轴\r\n    vertical: number = 0;\r\n    horizontal: number = 0;\r\n    // 刚体\r\n    rBody: cc.RigidBody = null;\r\n\r\n    onLoad() {\r\n        // 开户物理特性\r\n        cc.director.getPhysicsManager().enabled = true;\r\n    }\r\n\r\n    start() {\r\n        this.input();\r\n        // 初始化刚体\r\n        this.rBody = this.getComponent(cc.RigidBody);\r\n        // 获得子视图，子弹初始位置的node\r\n        this.firePoint = this.node.getChildByName('firePoint');\r\n    }\r\n\r\n    update(dt) {\r\n        // 移动\r\n        if (this.vertical != 0) {\r\n            // 垂直移动\r\n            this.rBody.linearVelocity = cc.v2(0, 60 * this.vertical);\r\n            // 旋转\r\n            this.node.rotation = this.vertical > 0 ? 0 : 180;\r\n            // 移动声音\r\n            if(cc.audioEngine.isMusicPlaying() == false){\r\n                cc.audioEngine.playMusic(this.moveClip,true);\r\n            }\r\n        } else if (this.horizontal != 0) {\r\n            // 水平移动\r\n            this.rBody.linearVelocity = cc.v2(this.horizontal * 60, 0);\r\n            // 旋转\r\n            this.node.rotation = this.horizontal > 0 ? 90 : 270;\r\n            // 移动声音\r\n            if (cc.audioEngine.isMusicPlaying() == false) {\r\n                cc.audioEngine.playMusic(this.moveClip, true);\r\n            }\r\n        } else {\r\n            // 停止移动\r\n            this.rBody.linearVelocity = cc.v2(0, 0);\r\n            // 停止声音\r\n            if (cc.audioEngine.isMusicPlaying() == true) {\r\n                cc.audioEngine.stopMusic();\r\n            }\r\n        }\r\n    }\r\n\r\n    // 开火\r\n    fire() {\r\n        // 声音\r\n        cc.audioEngine.playEffect(this.shootClip,false);\r\n        // 创建子弹\r\n        let blt = cc.instantiate(this.bullet);\r\n        // 子弹发射方向和tank 朝向一致\r\n        blt.rotation = this.node.rotation;\r\n        // 子弹加到当前场景上\r\n        blt.setParent(cc.director.getScene());\r\n        // 子弹的位置\r\n        // 将　firePoint　相对父视图的坐标 转化成 相对 map坐标\r\n        let pos = this.firePoint.convertToWorldSpaceAR(cc.v2(0,0));\r\n        blt.x = pos.x;\r\n        blt.y = pos.y;\r\n    }\r\n\r\n    input() {\r\n        // 按键\r\n        // 按下\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, (event) => {\r\n            if (event.keyCode == cc.macro.KEY.w) {\r\n                console.log('----------- w -----------');\r\n                this.vertical = 1;\r\n            }\r\n            if (event.keyCode == cc.macro.KEY.s) {\r\n                console.log('----------- s -----------');\r\n                this.vertical = -1;\r\n            }\r\n            if (event.keyCode == cc.macro.KEY.a) {\r\n                console.log('----------- a -----------');\r\n                this.horizontal = -1;\r\n            }\r\n            if (event.keyCode == cc.macro.KEY.d) {\r\n                console.log('----------- d -----------');\r\n                this.horizontal = 1;\r\n            }\r\n            // 按下u键开火\r\n            if (event.keyCode == cc.macro.KEY.u) {\r\n                console.log('----------- u -----------');\r\n                this.fire();\r\n            }\r\n        })\r\n        // 抬起\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, (event) => {\r\n            if (event.keyCode == cc.macro.KEY.w && this.vertical == 1) {\r\n                console.log('up----------- w -----------');\r\n                this.vertical = 0;\r\n            }\r\n            if (event.keyCode == cc.macro.KEY.s && this.vertical == -1) {\r\n                console.log('up----------- s -----------');\r\n                this.vertical = 0;\r\n            }\r\n            if (event.keyCode == cc.macro.KEY.a && this.horizontal == -1) {\r\n                console.log('up----------- a -----------');\r\n                this.horizontal = 0;\r\n            }\r\n            if (event.keyCode == cc.macro.KEY.d && this.horizontal == 1) {\r\n                console.log('up----------- d -----------');\r\n                this.horizontal = 0;\r\n            }\r\n        })\r\n    }\r\n}\r\n"]}